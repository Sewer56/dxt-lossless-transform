When refactoring, please preserve my coding style: keep variable names and loop structures unchanged unless explicitly instructed otherwise.
Please maintain the original code order (including assembly sections) and all comments intact, unless explicitly permitted to modify them.
Use the proper rustdoc format, putting elements in brackets like [`Color565`] and not `Color565`.